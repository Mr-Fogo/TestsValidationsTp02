using CreditImmo;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CreditImmoTest
{
    public class CSVMakerTest
    {
        [Fact]
        //est de la méthode MakeCSV
        public void MakeCSVTest()
        {
            CSVMaker csvMaker = new CSVMaker();
            string result = "N;Mensualite;Capital Rembourse Total;Capital Restant;Capital a rembourse;Interet;Cout Credit :;27473,15\r\n1;1187,37;1187,37;236286;925;262\r\n2;1187,37;2374,73;235098;926;261\r\n3;1187,37;3562,10;233911;927;260\r\n4;1187,37;4749,46;232724;928;259\r\n5;1187,37;5936,83;231536;929;258\r\n6;1187,37;7124,19;230349;931;257\r\n7;1187,37;8311,56;229162;932;256\r\n8;1187,37;9498,93;227974;933;254\r\n9;1187,37;10686,29;226787;934;253\r\n10;1187,37;11873,66;225599;935;252\r\n11;1187,37;13061,02;224412;936;251\r\n12;1187,37;14248,39;223225;938;250\r\n13;1187,37;15435,76;222037;939;249\r\n14;1187,37;16623,12;220850;940;247\r\n15;1187,37;17810,49;219663;941;246\r\n16;1187,37;18997,85;218475;942;245\r\n17;1187,37;20185,22;217288;944;244\r\n18;1187,37;21372,58;216101;945;243\r\n19;1187,37;22559,95;214913;946;241\r\n20;1187,37;23747,32;213726;947;240\r\n21;1187,37;24934,68;212538;948;239\r\n22;1187,37;26122,05;211351;949;238\r\n23;1187,37;27309,41;210164;951;237\r\n24;1187,37;28496,78;208976;952;236\r\n25;1187,37;29684,14;207789;953;234\r\n26;1187,37;30871,51;206602;954;233\r\n27;1187,37;32058,88;205414;955;232\r\n28;1187,37;33246,24;204227;957;231\r\n29;1187,37;34433,61;203040;958;230\r\n30;1187,37;35620,97;201852;959;228\r\n31;1187,37;36808,34;200665;960;227\r\n32;1187,37;37995,70;199477;961;226\r\n33;1187,37;39183,07;198290;963;225\r\n34;1187,37;40370,44;197103;964;224\r\n35;1187,37;41557,80;195915;965;222\r\n36;1187,37;42745,17;194728;966;221\r\n37;1187,37;43932,53;193541;967;220\r\n38;1187,37;45119,90;192353;969;219\r\n39;1187,37;46307,27;191166;970;218\r\n40;1187,37;47494,63;189979;971;216\r\n41;1187,37;48682,00;188791;972;215\r\n42;1187,37;49869,36;187604;973;214\r\n43;1187,37;51056,73;186416;975;213\r\n44;1187,37;52244,09;185229;976;211\r\n45;1187,37;53431,46;184042;977;210\r\n46;1187,37;54618,83;182854;978;209\r\n47;1187,37;55806,19;181667;980;208\r\n48;1187,37;56993,56;180480;981;207\r\n49;1187,37;58180,92;179292;982;205\r\n50;1187,37;59368,29;178105;983;204\r\n51;1187,37;60555,65;176917;984;203\r\n52;1187,37;61743,02;175730;986;202\r\n53;1187,37;62930,39;174543;987;200\r\n54;1187,37;64117,75;173355;988;199\r\n55;1187,37;65305,12;172168;989;198\r\n56;1187,37;66492,48;170981;991;197\r\n57;1187,37;67679,85;169793;992;195\r\n58;1187,37;68867,21;168606;993;194\r\n59;1187,37;70054,58;167419;994;193\r\n60;1187,37;71241,95;166231;996;192\r\n61;1187,37;72429,31;165044;997;191\r\n62;1187,37;73616,68;163856;998;189\r\n63;1187,37;74804,04;162669;999;188\r\n64;1187,37;75991,41;161482;1001;187\r\n65;1187,37;77178,78;160294;1002;186\r\n66;1187,37;78366,14;159107;1003;184\r\n67;1187,37;79553,51;157920;1004;183\r\n68;1187,37;80740,87;156732;1006;182\r\n69;1187,37;81928,24;155545;1007;181\r\n70;1187,37;83115,60;154358;1008;179\r\n71;1187,37;84302,97;153170;1009;178\r\n72;1187,37;85490,34;151983;1011;177\r\n73;1187,37;86677,70;150795;1012;175\r\n74;1187,37;87865,07;149608;1013;174\r\n75;1187,37;89052,43;148421;1014;173\r\n76;1187,37;90239,80;147233;1016;172\r\n77;1187,37;91427,16;146046;1017;170\r\n78;1187,37;92614,53;144859;1018;169\r\n79;1187,37;93801,90;143671;1020;168\r\n80;1187,37;94989,26;142484;1021;167\r\n81;1187,37;96176,63;141297;1022;165\r\n82;1187,37;97363,99;140109;1023;164\r\n83;1187,37;98551,36;138922;1025;163\r\n84;1187,37;99738,72;137734;1026;161\r\n85;1187,37;100926,09;136547;1027;160\r\n86;1187,37;102113,46;135360;1028;159\r\n87;1187,37;103300,82;134172;1030;158\r\n88;1187,37;104488,19;132985;1031;156\r\n89;1187,37;105675,55;131798;1032;155\r\n90;1187,37;106862,92;130610;1034;154\r\n91;1187,37;108050,29;129423;1035;152\r\n92;1187,37;109237,65;128236;1036;151\r\n93;1187,37;110425,02;127048;1038;150\r\n94;1187,37;111612,38;125861;1039;149\r\n95;1187,37;112799,75;124673;1040;147\r\n96;1187,37;113987,11;123486;1041;146\r\n97;1187,37;115174,48;122299;1043;145\r\n98;1187,37;116361,85;121111;1044;143\r\n99;1187,37;117549,21;119924;1045;142\r\n100;1187,37;118736,58;118737;1047;141\r\n101;1187,37;119923,94;117549;1048;139\r\n102;1187,37;121111,31;116362;1049;138\r\n103;1187,37;122298,67;115174;1051;137\r\n104;1187,37;123486,04;113987;1052;136\r\n105;1187,37;124673,41;112800;1053;134\r\n106;1187,37;125860,77;111612;1054;133\r\n107;1187,37;127048,14;110425;1056;132\r\n108;1187,37;128235,50;109238;1057;130\r\n109;1187,37;129422,87;108050;1058;129\r\n110;1187,37;130610,23;106863;1060;128\r\n111;1187,37;131797,60;105676;1061;126\r\n112;1187,37;132984,97;104488;1062;125\r\n113;1187,37;134172,33;103301;1064;124\r\n114;1187,37;135359,70;102113;1065;122\r\n115;1187,37;136547,06;100926;1066;121\r\n116;1187,37;137734,43;99739;1068;120\r\n117;1187,37;138921,80;98551;1069;118\r\n118;1187,37;140109,16;97364;1070;117\r\n119;1187,37;141296,53;96177;1072;116\r\n120;1187,37;142483,89;94989;1073;114\r\n121;1187,37;143671,26;93802;1074;113\r\n122;1187,37;144858,62;92615;1076;112\r\n123;1187,37;146045,99;91427;1077;110\r\n124;1187,37;147233,36;90240;1078;109\r\n125;1187,37;148420,72;89052;1080;108\r\n126;1187,37;149608,09;87865;1081;106\r\n127;1187,37;150795,45;86678;1083;105\r\n128;1187,37;151982,82;85490;1084;103\r\n129;1187,37;153170,18;84303;1085;102\r\n130;1187,37;154357,55;83116;1087;101\r\n131;1187,37;155544,92;81928;1088;99\r\n132;1187,37;156732,28;80741;1089;98\r\n133;1187,37;157919,65;79554;1091;97\r\n134;1187,37;159107,01;78366;1092;95\r\n135;1187,37;160294,38;77179;1093;94\r\n136;1187,37;161481,74;75991;1095;93\r\n137;1187,37;162669,11;74804;1096;91\r\n138;1187,37;163856,48;73617;1098;90\r\n139;1187,37;165043,84;72429;1099;88\r\n140;1187,37;166231,21;71242;1100;87\r\n141;1187,37;167418,57;70055;1102;86\r\n142;1187,37;168605,94;68867;1103;84\r\n143;1187,37;169793,31;67680;1104;83\r\n144;1187,37;170980,67;66492;1106;82\r\n145;1187,37;172168,04;65305;1107;80\r\n146;1187,37;173355,40;64118;1109;79\r\n147;1187,37;174542,77;62930;1110;77\r\n148;1187,37;175730,13;61743;1111;76\r\n149;1187,37;176917,50;60556;1113;75\r\n150;1187,37;178104,87;59368;1114;73\r\n151;1187,37;179292,23;58181;1115;72\r\n152;1187,37;180479,60;56994;1117;71\r\n153;1187,37;181666,96;55806;1118;69\r\n154;1187,37;182854,33;54619;1120;68\r\n155;1187,37;184041,69;53431;1121;66\r\n156;1187,37;185229,06;52244;1122;65\r\n157;1187,37;186416,43;51057;1124;64\r\n158;1187,37;187603,79;49869;1125;62\r\n159;1187,37;188791,16;48682;1127;61\r\n160;1187,37;189978,52;47495;1128;59\r\n161;1187,37;191165,89;46307;1129;58\r\n162;1187,37;192353,25;45120;1131;56\r\n163;1187,37;193540,62;43933;1132;55\r\n164;1187,37;194727,99;42745;1134;54\r\n165;1187,37;195915,35;41558;1135;52\r\n166;1187,37;197102,72;40370;1137;51\r\n167;1187,37;198290,08;39183;1138;49\r\n168;1187,37;199477,45;37996;1139;48\r\n169;1187,37;200664,82;36808;1141;47\r\n170;1187,37;201852,18;35621;1142;45\r\n171;1187,37;203039,55;34434;1144;44\r\n172;1187,37;204226,91;33246;1145;42\r\n173;1187,37;205414,28;32059;1147;41\r\n174;1187,37;206601,64;30872;1148;39\r\n175;1187,37;207789,01;29684;1149;38\r\n176;1187,37;208976,38;28497;1151;37\r\n177;1187,37;210163,74;27309;1152;35\r\n178;1187,37;211351,11;26122;1154;34\r\n179;1187,37;212538,47;24935;1155;32\r\n180;1187,37;213725,84;23747;1157;31\r\n181;1187,37;214913,20;22560;1158;29\r\n182;1187,37;216100,57;21373;1160;28\r\n183;1187,37;217287,94;20185;1161;26\r\n184;1187,37;218475,30;18998;1162;25\r\n185;1187,37;219662,67;17810;1164;23\r\n186;1187,37;220850,03;16623;1165;22\r\n187;1187,37;222037,40;15436;1167;21\r\n188;1187,37;223224,76;14248;1168;19\r\n189;1187,37;224412,13;13061;1170;18\r\n190;1187,37;225599,50;11874;1171;16\r\n191;1187,37;226786,86;10686;1173;15\r\n192;1187,37;227974,23;9499;1174;13\r\n193;1187,37;229161,59;8312;1176;12\r\n194;1187,37;230348,96;7124;1177;10\r\n195;1187,37;231536,33;5937;1178;9\r\n196;1187,37;232723,69;4749;1180;7\r\n197;1187,37;233911,06;3562;1181;6\r\n198;1187,37;235098,42;2375;1183;4\r\n199;1187,37;236285,79;1187;1184;3\r\n200;1187,37;237473,15;0;1186;1\r\n";
            Assert.Equal(result, csvMaker.MakeCSV(200, 210000, 1.5));
        }
    }
}
